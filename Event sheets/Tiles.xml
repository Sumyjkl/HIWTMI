<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>Tiles</name>
    <events>
        <comment># TILES&#x0D;&#x0A;# tiles_ map_&#x0D;&#x0A;# Map generation and updating, most of which I don&apos;t understand&#x0D;&#x0A;</comment>
        <comment>map</comment>
        <variable constant="0" name="map_caveDensity" sid="280220761036169" static="0" type="number">30</variable>
        <variable constant="0" name="map_gemDensity" sid="392666142481395" static="0" type="number">10</variable>
        <variable comment="size of tiles in tilemap" constant="0" name="tileMapSize" sid="565947161547990" static="0" type="number">16</variable>
        <event-group description="" sid="471789423016500" title="tileGroup">
            <sub-events>
                <comment>set size</comment>
                <event-block sid="605615089052894">
                    <conditions>
                        <condition id="0" name="On function" sid="982772826068480" type="f">
                            <param id="0" name="Name">&quot;tiles_arrayInit&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="697039056228175">
                            <conditions />
                            <actions>
                                <action id="1" name="Set size" sid="578645322153489" type="TileArray">
                                    <param id="0" name="Width">ceil(TileMap.Width/16) + 1</param>
                                    <param id="1" name="Height">ceil(TileMap.Height/16) + 1</param>
                                    <param id="2" name="Depth">1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>fill entire array with 1</comment>
                <event-block sid="746205346366473">
                    <conditions>
                        <condition id="0" name="On function" sid="905078937436831" type="f">
                            <param id="0" name="Name">&quot;tiles_fillAll&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="179189541738922">
                            <conditions>
                                <condition id="3" name="For each element" sid="143086910762501" type="TileArray">
                                    <param id="0" name="Axes">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="3" name="Set at XY" sid="537041816618810" type="TileArray">
                                    <param id="0" name="X">TileArray.CurX</param>
                                    <param id="1" name="Y">TileArray.CurY</param>
                                    <param id="2" name="Value">1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>add prefabs</comment>
                <event-block sid="373121098589189">
                    <conditions>
                        <condition id="0" name="On function" sid="512524082022917" type="f">
                            <param id="0" name="Name">&quot;tiles_generate&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="583904866388506">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="236240442508691" type="f">
                                    <param id="0" name="Name">&quot;tiles_fillAll&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="460167184827545">
                            <conditions>
                                <condition id="-10" name="For" sid="317147207649443" type="System">
                                    <param id="0" name="Name">&quot;&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">map_caveDensity</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="825557267180383" type="f">
                                    <param id="0" name="Name">&quot;tiles_addPrefab&quot;</param>
                                    <param id="1" name="Parameter {n}">int(random(TileArray.Width)){###}int(random(TileArray.Height)){###}tilePrefabs.At(int(random(tilePrefabs.Width)), 0)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>generate and update</comment>
                <event-block sid="850422057768356">
                    <conditions>
                        <condition id="0" name="On function" sid="850749378376609" type="f">
                            <param id="0" name="Name">&quot;tiles_init&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="571795114972873">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="702073220289822" type="f">
                                    <param id="0" name="Name">&quot;tiles_generate&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                                <action id="0" name="Call function" sid="171919339807816" type="f">
                                    <param id="0" name="Name">&quot;tiles_updateAll&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>update tiles</comment>
                <event-block sid="446691396146544">
                    <conditions>
                        <condition id="0" name="On function" sid="583412681539363" type="f">
                            <param id="0" name="Name">&quot;tiles_updateAll&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="434066151339882">
                            <conditions>
                                <condition id="-10" name="For" sid="375593794343890" type="System">
                                    <param id="0" name="Name">&quot;X&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">TileArray.Width</param>
                                </condition>
                                <condition id="-10" name="For" sid="622965385983574" type="System">
                                    <param id="0" name="Name">&quot;Y&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">TileArray.Height</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="693752026643375">
                                    <conditions />
                                    <actions>
                                        <action id="0" name="Call function" sid="900357207839660" type="f">
                                            <param id="0" name="Name">&quot;tiles_update&quot;</param>
                                            <param id="1" name="Parameter {n}">loopindex(&quot;X&quot;){###}loopindex(&quot;Y&quot;)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>load tiles from tilmap to the array</comment>
                <event-block sid="672318401903548">
                    <conditions>
                        <condition id="0" name="On function" sid="404101413105960" type="f">
                            <param id="0" name="Name">&quot;tiles_loadToArray&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="656823216574621">
                            <conditions>
                                <condition id="-10" name="For" sid="360961996908352" type="System">
                                    <param id="0" name="Name">&quot;X&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">TileArray.Width</param>
                                </condition>
                                <condition id="-10" name="For" sid="263476310782973" type="System">
                                    <param id="0" name="Name">&quot;Y&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">TileArray.Height</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="759726375076203">
                                    <conditions>
                                        <condition id="0" name="Compare tile at" sid="968922021050610" type="TileMap">
                                            <param id="0" name="Tile X">loopindex(&quot;X&quot;)</param>
                                            <param id="1" name="Tile Y">loopindex(&quot;Y&quot;)</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Tile">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="3" name="Set at XY" sid="991031822035398" type="TileArray">
                                            <param id="0" name="X">loopindex(&quot;X&quot;)</param>
                                            <param id="1" name="Y">loopindex(&quot;Y&quot;)</param>
                                            <param id="2" name="Value">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>filter tile range</comment>
                <event-block sid="241993289735235">
                    <conditions>
                        <condition id="0" name="On function" sid="295164175366444" type="f">
                            <param id="0" name="Name">&quot;tiles_update&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="tmpX" sid="826006775586740" static="0" type="number">0</variable>
                        <variable constant="0" name="tmpY" sid="170966848601652" static="0" type="number">0</variable>
                        <variable constant="0" name="tmpZ" sid="970574680979366" static="0" type="number">0</variable>
                        <variable constant="0" name="tmpReturn" sid="621402184755961" static="0" type="text"></variable>
                        <event-block sid="763929212032724">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="605542591973996" type="System">
                                    <param id="0" name="Variable">tmpX</param>
                                    <param id="1" name="Value">f.Param(0)</param>
                                </action>
                                <action id="-9" name="Set value" sid="457846288421357" type="System">
                                    <param id="0" name="Variable">tmpY</param>
                                    <param id="1" name="Value">f.Param(1)</param>
                                </action>
                                <action id="-9" name="Set value" sid="570909644073211" type="System">
                                    <param id="0" name="Variable">tmpZ</param>
                                    <param id="1" name="Value">TileArray.At(tmpX, tmpY)</param>
                                </action>
                                <action id="-9" name="Set value" sid="427841683357792" type="System">
                                    <param id="0" name="Variable">tmpReturn</param>
                                    <param id="1" name="Value">&quot;&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>same</comment>
                        <event-block disabled="1" sid="975490314226653">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="298913769177031" type="System">
                                    <param id="0" name="Variable">tmpZ</param>
                                    <param id="1" name="Comparison">5</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block disabled="1" sid="994999340954356">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="217518408996048" type="TileArray">
                                            <param id="0" name="X">tmpX</param>
                                            <param id="1" name="Y">tmpY-1</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="817623717755033" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="300063751926735">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="487229582581001" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="720174628145464" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="248385007799272">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="864806885817161" type="TileArray">
                                            <param id="0" name="X">tmpX</param>
                                            <param id="1" name="Y">tmpY+1</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="188937984869264" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="601764420355750">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="860544355923830" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="536828365103982" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="189091064781668">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="919044089985852" type="TileArray">
                                            <param id="0" name="X">tmpX-1</param>
                                            <param id="1" name="Y">tmpY</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="130986407697326" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="535929221719487">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="316901549600018" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="891471918320792" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="424196530748264">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="903784593053357" type="TileArray">
                                            <param id="0" name="X">tmpX+1</param>
                                            <param id="1" name="Y">tmpY</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="224167289120368" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="168169423165612">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="531771267270054" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="483860033647593" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="656747217502585">
                                    <conditions />
                                    <actions>
                                        <action id="1" name="Set tile" sid="402429733607594" type="TileMap">
                                            <param id="0" name="Tile X">tmpX</param>
                                            <param id="1" name="Tile Y">tmpY</param>
                                            <param id="2" name="Tile">(tmpZ-1) * 20 + tileForms.Get(tmpReturn)</param>
                                            <param id="3" name="State">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>any with other rules (you can also omit certain tile types from the test</comment>
                        <event-block sid="901303901743422">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="973797656651429" type="System">
                                    <param id="0" name="Variable">tmpZ</param>
                                    <param id="1" name="Comparison">5</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                                <condition id="-14" inverted="1" name="Compare variable" sid="203939055463370" type="System">
                                    <param id="0" name="Variable">tmpZ</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">9</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <comment></comment>
                                <comment>if tile above, add a 1 to the current string</comment>
                                <comment>Basically, it goes through and adds up a string like 10011 and then searches for it in the dictionary to see if it has that tile mapped. If it does, it sets that tile. This way you can program tiles to be a certain way based on their surroundings.</comment>
                                <comment>It&apos;s also less CPU intensive to use a dictionary than a thousand if statements</comment>
                                <event-block sid="413840609183967">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="378181797072177" type="TileArray">
                                            <param id="0" name="X">tmpX</param>
                                            <param id="1" name="Y">tmpY-1</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="242810116284837" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="116702280869892">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="421238910944057" type="System" />
                                        <condition id="1" inverted="1" name="Compare at XY" sid="621369031103598" type="TileArray">
                                            <param id="0" name="X">tmpX</param>
                                            <param id="1" name="Y">tmpY-1</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="856882546608906" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="630155219137332">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="669947048201711" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="744145570796537" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment></comment>
                                <event-block sid="869767386895408">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="300613432904332" type="TileArray">
                                            <param id="0" name="X">tmpX</param>
                                            <param id="1" name="Y">tmpY+1</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="365056665056922" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="461240922943715">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="994166132390595" type="System" />
                                        <condition id="1" inverted="1" name="Compare at XY" sid="658094980121059" type="TileArray">
                                            <param id="0" name="X">tmpX</param>
                                            <param id="1" name="Y">tmpY+1</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="933126444778457" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="319091999729247">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="636941146944616" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="336211607833243" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment></comment>
                                <event-block sid="537109558500468">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="324538892109405" type="TileArray">
                                            <param id="0" name="X">tmpX-1</param>
                                            <param id="1" name="Y">tmpY</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="695744336582980" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="611239664619073">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="460502718807056" type="System" />
                                        <condition id="1" inverted="1" name="Compare at XY" sid="361169683618458" type="TileArray">
                                            <param id="0" name="X">tmpX-1</param>
                                            <param id="1" name="Y">tmpY</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="434621098488905" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="807491748227713">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="805979159812762" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="199891454534842" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment></comment>
                                <event-block sid="614855094258598">
                                    <conditions>
                                        <condition id="1" name="Compare at XY" sid="737397295155759" type="TileArray">
                                            <param id="0" name="X">tmpX+1</param>
                                            <param id="1" name="Y">tmpY</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">tmpZ</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="329814793168945" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="556530348915510">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="423103455925348" type="System" />
                                        <condition id="1" inverted="1" name="Compare at XY" sid="223436727150750" type="TileArray">
                                            <param id="0" name="X">tmpX+1</param>
                                            <param id="1" name="Y">tmpY</param>
                                            <param id="2" name="Comparison">0</param>
                                            <param id="3" name="Value">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="806677388320797" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;1&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="358695401039651">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="227460621802800" type="System" />
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Set value" sid="932379882568521" type="System">
                                            <param id="0" name="Variable">tmpReturn</param>
                                            <param id="1" name="Value">tmpReturn &amp; &quot;0&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>only if has key made from all the 10001011 stuff</comment>
                                <event-block sid="160164526138733">
                                    <conditions>
                                        <condition id="3" name="Has key" sid="488745859787168" type="tileForms">
                                            <param id="0" name="Key">tmpReturn</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Set tile" sid="504482230176583" type="TileMap">
                                            <param id="0" name="Tile X">tmpX</param>
                                            <param id="1" name="Tile Y">tmpY</param>
                                            <param id="2" name="Tile">(tmpZ-1) * 20 + tileForms.Get(tmpReturn)</param>
                                            <param id="3" name="State">0</param>
                                        </action>
                                        <action disabled="1" id="0" name="Call function" sid="897745518088005" type="f">
                                            <param id="0" name="Name">&quot;tiles_solidTest&quot;</param>
                                            <param id="1" name="Parameter {n}">tmpX{###}tmpY{###}tmpZ{###}tmpReturn</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>otherwise just delete the tile</comment>
                                <event-block sid="739204300424602">
                                    <conditions>
                                        <condition id="-22" name="Else" sid="218823465805641" type="System" />
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="1" name="Set tile" sid="868180349214122" type="TileMap">
                                            <param id="0" name="Tile X">tmpX</param>
                                            <param id="1" name="Tile Y">tmpY</param>
                                            <param id="2" name="Tile">11</param>
                                            <param id="3" name="State">0</param>
                                        </action>
                                        <action id="0" name="Erase tile" sid="136179048698709" type="TileMap">
                                            <param id="0" name="Tile X">tmpX</param>
                                            <param id="1" name="Tile Y">tmpY</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>if it isn&apos;t a tile, delete it</comment>
                        <event-block sid="709614030771405">
                            <conditions>
                                <condition id="-22" name="Else" sid="159664300610345" type="System" />
                                <condition id="-14" inverted="1" name="Compare variable" sid="879797268633693" type="System">
                                    <param id="0" name="Variable">tmpZ</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">9</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Erase tile" sid="663166009237885" type="TileMap">
                                    <param id="0" name="Tile X">tmpX</param>
                                    <param id="1" name="Tile Y">tmpY</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block disabled="1" sid="740789905035912">
                    <conditions>
                        <condition id="0" name="On function" sid="696064525529829" type="f">
                            <param id="0" name="Name">&quot;tiles_solidTest&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block disabled="1" sid="433580908252894">
                            <conditions>
                                <condition id="-21" name="Is between values" sid="861615089693193" type="System">
                                    <param id="0" name="Value">tileForms.Get(f.Param(3))</param>
                                    <param id="1" name="Lower bound">10</param>
                                    <param id="2" name="Upper bound">19</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="848992361769436" type="System">
                                    <param id="0" name="First value">f.Param(2)</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Second value">4</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block disabled="1" sid="663551999803385">
                                    <conditions>
                                        <condition behavior="Solid" id="0" name="Is enabled" sid="125838728595778" type="TileMap" />
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Erase tile" sid="648336400653668" type="TileMap">
                                            <param id="0" name="Tile X">f.Param(0)</param>
                                            <param id="1" name="Tile Y">f.Param(1)</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="467267581974239">
                                    <conditions>
                                        <condition behavior="Solid" id="0" inverted="1" name="Is enabled" sid="865940839586587" type="TileMap" />
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Set tile" sid="666927412622965" type="TileMap">
                                            <param id="0" name="Tile X">f.Param(0)</param>
                                            <param id="1" name="Tile Y">f.Param(1)</param>
                                            <param id="2" name="Tile">(f.Param(2)-1) * 20 + tileForms.Get(f.Param(3))</param>
                                            <param id="3" name="State">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block disabled="1" sid="756543144950090">
                            <conditions>
                                <condition id="-22" name="Else" sid="118268047006990" type="System" />
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block disabled="1" sid="660774405188466">
                                    <conditions>
                                        <condition behavior="Solid" id="0" name="Is enabled" sid="516095506229404" type="TileMap" />
                                    </conditions>
                                    <actions>
                                        <action id="1" name="Set tile" sid="224533980164102" type="TileMap">
                                            <param id="0" name="Tile X">f.Param(0)</param>
                                            <param id="1" name="Tile Y">f.Param(1)</param>
                                            <param id="2" name="Tile">(f.Param(2)-1) * 20 + tileForms.Get(f.Param(3))</param>
                                            <param id="3" name="State">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block disabled="1" sid="166327078442118">
                                    <conditions>
                                        <condition behavior="Solid" id="0" inverted="1" name="Is enabled" sid="244086631035428" type="TileMap" />
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Erase tile" sid="257046501000312" type="TileMap">
                                            <param id="0" name="Tile X">f.Param(0)</param>
                                            <param id="1" name="Tile Y">f.Param(1)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="824945120484189">
                    <conditions>
                        <condition id="0" name="On function" sid="550342940631051" type="f">
                            <param id="0" name="Name">&quot;tiles_solidEnable&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                </event-block>
                <comment>make rules for filter</comment>
                <event-block disabled="1" sid="858985147037134">
                    <conditions>
                        <condition id="0" name="On function" sid="295059915845865" type="f">
                            <param id="0" name="Name">&quot;tiles_formsInit&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <comment>no top</comment>
                        <event-block disabled="1" sid="627539714525883">
                            <conditions />
                            <actions>
                                <action id="0" name="Add key" sid="946365943270644" type="tileForms">
                                    <param id="0" name="Key">&quot;0000&quot;</param>
                                    <param id="1" name="Value">10</param>
                                </action>
                                <action id="0" name="Add key" sid="817385906954737" type="tileForms">
                                    <param id="0" name="Key">&quot;0100&quot;</param>
                                    <param id="1" name="Value">11</param>
                                </action>
                                <action id="0" name="Add key" sid="766981735152819" type="tileForms">
                                    <param id="0" name="Key">&quot;0010&quot;</param>
                                    <param id="1" name="Value">12</param>
                                </action>
                                <action id="0" name="Add key" sid="482687523683520" type="tileForms">
                                    <param id="0" name="Key">&quot;0001&quot;</param>
                                    <param id="1" name="Value">13</param>
                                </action>
                                <action id="0" name="Add key" sid="790098322753900" type="tileForms">
                                    <param id="0" name="Key">&quot;0110&quot;</param>
                                    <param id="1" name="Value">14</param>
                                </action>
                                <action id="0" name="Add key" sid="318072834553250" type="tileForms">
                                    <param id="0" name="Key">&quot;0101&quot;</param>
                                    <param id="1" name="Value">15</param>
                                </action>
                                <action id="0" name="Add key" sid="765803512211563" type="tileForms">
                                    <param id="0" name="Key">&quot;0011&quot;</param>
                                    <param id="1" name="Value">16</param>
                                </action>
                                <action id="0" name="Add key" sid="222674557614800" type="tileForms">
                                    <param id="0" name="Key">&quot;0111&quot;</param>
                                    <param id="1" name="Value">17</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>other</comment>
                        <event-block disabled="1" sid="375982034711900">
                            <conditions />
                            <actions>
                                <action id="0" name="Add key" sid="481223103000909" type="tileForms">
                                    <param id="0" name="Key">&quot;1100&quot;</param>
                                    <param id="1" name="Value">20</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>top</comment>
                        <event-block disabled="1" sid="767600889214495">
                            <conditions />
                            <actions>
                                <action id="0" name="Add key" sid="218763841557151" type="tileForms">
                                    <param id="0" name="Key">&quot;1000&quot;</param>
                                    <param id="1" name="Value">21</param>
                                </action>
                                <action id="0" name="Add key" sid="123598465112385" type="tileForms">
                                    <param id="0" name="Key">&quot;1010&quot;</param>
                                    <param id="1" name="Value">22</param>
                                </action>
                                <action id="0" name="Add key" sid="194494339543335" type="tileForms">
                                    <param id="0" name="Key">&quot;1001&quot;</param>
                                    <param id="1" name="Value">23</param>
                                </action>
                                <action id="0" name="Add key" sid="905659283997490" type="tileForms">
                                    <param id="0" name="Key">&quot;1110&quot;</param>
                                    <param id="1" name="Value">24</param>
                                </action>
                                <action id="0" name="Add key" sid="282648954745869" type="tileForms">
                                    <param id="0" name="Key">&quot;1101&quot;</param>
                                    <param id="1" name="Value">25</param>
                                </action>
                                <action id="0" name="Add key" sid="433614297039767" type="tileForms">
                                    <param id="0" name="Key">&quot;1011&quot;</param>
                                    <param id="1" name="Value">26</param>
                                </action>
                                <action id="0" name="Add key" sid="672298642109797" type="tileForms">
                                    <param id="0" name="Key">&quot;1111&quot;</param>
                                    <param id="1" name="Value">27</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>make the dictionary with the tile mappings</comment>
                <event-block sid="777638906776219">
                    <conditions>
                        <condition id="0" name="On function" sid="314739698493338" type="f">
                            <param id="0" name="Name">&quot;tiles_formsInit&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <comment>no top</comment>
                        <event-block sid="577625635710155">
                            <conditions />
                            <actions>
                                <action id="0" name="Add key" sid="155095600069925" type="tileForms">
                                    <param id="0" name="Key">&quot;1111&quot;</param>
                                    <param id="1" name="Value">10</param>
                                </action>
                                <action id="0" name="Add key" sid="870726690027072" type="tileForms">
                                    <param id="0" name="Key">&quot;1011&quot;</param>
                                    <param id="1" name="Value">11</param>
                                </action>
                                <action id="0" name="Add key" sid="649786989646519" type="tileForms">
                                    <param id="0" name="Key">&quot;1101&quot;</param>
                                    <param id="1" name="Value">12</param>
                                </action>
                                <action id="0" name="Add key" sid="908446640163945" type="tileForms">
                                    <param id="0" name="Key">&quot;1110&quot;</param>
                                    <param id="1" name="Value">13</param>
                                </action>
                                <action id="0" name="Add key" sid="971762849014342" type="tileForms">
                                    <param id="0" name="Key">&quot;1001&quot;</param>
                                    <param id="1" name="Value">14</param>
                                </action>
                                <action id="0" name="Add key" sid="604059333121442" type="tileForms">
                                    <param id="0" name="Key">&quot;1010&quot;</param>
                                    <param id="1" name="Value">15</param>
                                </action>
                                <action id="0" name="Add key" sid="124633932695548" type="tileForms">
                                    <param id="0" name="Key">&quot;1100&quot;</param>
                                    <param id="1" name="Value">16</param>
                                </action>
                                <action id="0" name="Add key" sid="732593210637778" type="tileForms">
                                    <param id="0" name="Key">&quot;1000&quot;</param>
                                    <param id="1" name="Value">17</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>other</comment>
                        <event-block sid="151996803409308">
                            <conditions />
                            <actions>
                                <action id="0" name="Add key" sid="752129037120382" type="tileForms">
                                    <param id="0" name="Key">&quot;0011&quot;</param>
                                    <param id="1" name="Value">20</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>top</comment>
                        <event-block sid="609648017331559">
                            <conditions />
                            <actions>
                                <action id="0" name="Add key" sid="158739774354246" type="tileForms">
                                    <param id="0" name="Key">&quot;0111&quot;</param>
                                    <param id="1" name="Value">21</param>
                                </action>
                                <action id="0" name="Add key" sid="968911732237592" type="tileForms">
                                    <param id="0" name="Key">&quot;0101&quot;</param>
                                    <param id="1" name="Value">22</param>
                                </action>
                                <action id="0" name="Add key" sid="823911056365024" type="tileForms">
                                    <param id="0" name="Key">&quot;0110&quot;</param>
                                    <param id="1" name="Value">23</param>
                                </action>
                                <action id="0" name="Add key" sid="940843142517324" type="tileForms">
                                    <param id="0" name="Key">&quot;0001&quot;</param>
                                    <param id="1" name="Value">24</param>
                                </action>
                                <action id="0" name="Add key" sid="113773667548589" type="tileForms">
                                    <param id="0" name="Key">&quot;0010&quot;</param>
                                    <param id="1" name="Value">25</param>
                                </action>
                                <action id="0" name="Add key" sid="178228090717732" type="tileForms">
                                    <param id="0" name="Key">&quot;0100&quot;</param>
                                    <param id="1" name="Value">26</param>
                                </action>
                                <action id="0" name="Add key" sid="244513230413497" type="tileForms">
                                    <param id="0" name="Key">&quot;0000&quot;</param>
                                    <param id="1" name="Value">27</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>update [0]x[1] square around object</comment>
                <event-block sid="659607921194668">
                    <conditions>
                        <condition id="0" name="On function" sid="487347923258004" type="f">
                            <param id="0" name="Name">&quot;tiles_updateArea&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="234277192152259">
                            <conditions>
                                <condition id="-10" name="For" sid="371280755013830" type="System">
                                    <param id="0" name="Name">&quot;X&quot;</param>
                                    <param id="1" name="Start index">f.Param(0)-1</param>
                                    <param id="2" name="End index">f.Param(0)+1</param>
                                </condition>
                                <condition id="-10" name="For" sid="951412278660553" type="System">
                                    <param id="0" name="Name">&quot;Y&quot;</param>
                                    <param id="1" name="Start index">f.Param(1)-1</param>
                                    <param id="2" name="End index">f.Param(1)+1</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="764554571374219">
                                    <conditions />
                                    <actions>
                                        <action id="0" name="Call function" sid="162283321538446" type="f">
                                            <param id="0" name="Name">&quot;tiles_update&quot;</param>
                                            <param id="1" name="Parameter {n}">loopindex(&quot;X&quot;){###}loopindex(&quot;Y&quot;)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>set a tile in a certain XY</comment>
                <event-block sid="409266098844962">
                    <conditions>
                        <condition id="0" name="On function" sid="305739735434467" type="f">
                            <param id="0" name="Name">&quot;tiles_addTile&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="516834474206287">
                            <conditions />
                            <actions>
                                <action id="3" name="Set at XY" sid="464055124337194" type="TileArray">
                                    <param id="0" name="X">f.Param(0)</param>
                                    <param id="1" name="Y">f.Param(1)</param>
                                    <param id="2" name="Value">f.Param(2)</param>
                                </action>
                                <action id="0" name="Call function" sid="456178188439962" type="f">
                                    <param id="0" name="Name">&quot;tiles_updateArea&quot;</param>
                                    <param id="1" name="Parameter {n}">f.Param(0){###}f.Param(1)</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>add a prefab cave / ore deposit</comment>
                <event-block sid="469797293143586">
                    <conditions>
                        <condition id="0" name="On function" sid="916431317456658" type="f">
                            <param id="0" name="Name">&quot;tiles_addPrefab&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="682560748209228">
                            <conditions>
                                <condition id="-10" name="For" sid="560022577880123" type="System">
                                    <param id="0" name="Name">&quot;X&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">len(tokenat(f.Param(2), 4, &quot;;&quot;))</param>
                                </condition>
                                <condition id="-10" name="For" sid="128348474684137" type="System">
                                    <param id="0" name="Name">&quot;Y&quot;</param>
                                    <param id="1" name="Start index">0</param>
                                    <param id="2" name="End index">tokencount(f.Param(2), &quot;;&quot;) - 4</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <variable constant="0" name="tmpLine" sid="848858901058709" static="0" type="text"></variable>
                                <event-block sid="137557626295286">
                                    <conditions />
                                    <actions>
                                        <action id="-9" name="Set value" sid="176708599142427" type="System">
                                            <param id="0" name="Variable">tmpLine</param>
                                            <param id="1" name="Value">tokenat(f.Param(2), loopindex(&quot;Y&quot;) + 4, &quot;;&quot;)</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <event-block sid="474715522320823">
                                    <conditions>
                                        <condition id="-8" name="Compare two values" sid="558938791134005" type="System">
                                            <param id="0" name="First value">mid(tmpLine, loopindex(&quot;X&quot;), 1)</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Second value">&quot;1&quot;</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="0" name="Call function" sid="381263332745842" type="f">
                                            <param id="0" name="Name">&quot;tiles_addTile&quot;</param>
                                            <param id="1" name="Parameter {n}">loopindex(&quot;X&quot;) + f.Param(0){###}loopindex(&quot;Y&quot;) + f.Param(1){###}int(tokenat(f.Param(2), 0, &quot;;&quot;))</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>clear and get ready prefab list</comment>
                <event-block sid="569018206477774">
                    <conditions>
                        <condition id="0" name="On function" sid="344686897576344" type="f">
                            <param id="0" name="Name">&quot;tiles_prefabInit&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="928768640181751">
                            <conditions />
                            <actions>
                                <action id="0" name="Clear" sid="210851565299215" type="tilePrefabs" />
                            </actions>
                        </event-block>
                        <event-block disabled="1" sid="272474415267494">
                            <conditions>
                                <condition id="-10" name="For" sid="180000760138214" type="System">
                                    <param id="0" name="Name">&quot;&quot;</param>
                                    <param id="1" name="Start index">1</param>
                                    <param id="2" name="End index">tokencount(f.Param(0), &quot;CAVE&quot;)</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block disabled="1" sid="568629962152146">
                                    <conditions />
                                    <actions>
                                        <action id="5" name="Push" sid="490995736824704" type="tilePrefabs">
                                            <param id="0" name="Where">0</param>
                                            <param id="1" name="Value">tokenat(f.Param(0), loopindex, &quot;CAVE&quot;)</param>
                                            <param id="2" name="Axis">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>add a list of prefabs from text</comment>
                <event-block sid="149528276488939">
                    <conditions>
                        <condition id="0" name="On function" sid="548082447264985" type="f">
                            <param id="0" name="Name">&quot;tiles_prefabAppend&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="532448345487072">
                            <conditions>
                                <condition id="-10" name="For" sid="633682155964406" type="System">
                                    <param id="0" name="Name">&quot;&quot;</param>
                                    <param id="1" name="Start index">1</param>
                                    <param id="2" name="End index">tokencount(f.Param(0), &quot;CAVE&quot;)</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="784900891318364">
                                    <conditions />
                                    <actions>
                                        <action id="5" name="Push" sid="260610331887038" type="tilePrefabs">
                                            <param id="0" name="Where">0</param>
                                            <param id="1" name="Value">tokenat(f.Param(0), loopindex, &quot;CAVE&quot;)</param>
                                            <param id="2" name="Axis">0</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
